# Combine the plots using subplot function
combined_figure <- subplot(p1, p2, p3, p4, p5, p6, p7, p8, p9, nrows = 3, shareX = TRUE, shareY = TRUE)
combined_figure <- layout(
combined_figure,
title = paste0(feature, " Plot - ", name),
titlefont = list(size = 16)  # You can adjust the font size as needed
)
# Show the combined figure
return(combined_figure)
}
KL1 <- function(u1, u2, std1, std2){
kl_divergence <- log(std2 / std1)
return(kl_divergence)
}
KL2 <- function(u1, u2, std1, std2){
kl_divergence <- (std1^2 + (u1 - u2)^2) / (2 * std2^2) - 0.5
return(kl_divergence)
}
KL_all1 <- function(u1_list, u2, std1_list, std2){
KLs = c()
for (i in 1:length(u1_list)){
distance = KL1(u1_list[i], u2, std1_list[i], std2)
KLs = c(KLs, distance)
}
return(mean(KLs))
}
KL_all2 <- function(u1_list, u2, std1_list, std2){
KLs = c()
for (i in 1:length(u1_list)){
distance = KL2(u1_list[i], u2, std1_list[i], std2)
KLs = c(KLs, distance)
}
return(mean(KLs))
}
InD_Dataset = "MNIST"
OOD_Datasets = c("FashionMNIST", "Cifar_10", "SVHN", "Imagenet_r", "Imagenet_c")
model_fit_test(trainset = InD_Dataset, testsets = OOD_Datasets, n_tr = 1000, n_ts = 1000, f = 16)  # Run only once, specify the training samples to use
rm(list = ls())
source("function.R")
InD_Dataset = "MNIST"
OOD_Datasets = c("FashionMNIST", "Cifar_10", "SVHN", "Imagenet_r", "Imagenet_c")
model_fit_test(trainset = InD_Dataset, testsets = OOD_Datasets, n_tr = 1000, n_ts = 1000, f = 10)  # Run only once, specify the training samples to use
InD_Dataset = "MNIST"
OOD_Datasets = c("FashionMNIST", "Cifar_10", "SVHN", "Imagenet_r", "Imagenet_c")
f = 10
list3000_0.9_InD = c()
list3000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 3000)
list3000_0.9_InD = c(list3000_0.9_InD, pred$ID_all)
list3000_0.9_OOD = c(list3000_0.9_OOD, pred$OOD_all)
}
list3000_0.8_InD = c()
list3000_0.8_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 3000)
list3000_0.8_InD = c(list3000_0.8_InD, pred$ID_all)
list3000_0.8_OOD = c(list3000_0.8_OOD, pred$OOD_all)
}
list1000_0.9_InD = c()
list1000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 1000)
list1000_0.9_InD = c(list1000_0.9_InD, pred$ID_all)
list1000_0.9_OOD = c(list1000_0.9_OOD, pred$OOD_all)
}
list1000_0.8_InD = c()
list1000_0.8_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 1000)
list1000_0.8_InD = c(list1000_0.8_InD, pred$ID_all)
list1000_0.8_OOD = c(list1000_0.8_OOD, pred$OOD_all)
}
MNIST = data.frame(InD3000_0.9 = list3000_0.9_InD,
OOD3000_0.9 = list3000_0.9_OOD,
InD3000_0.8 = list3000_0.8_InD,
OOD3000_0.8 = list3000_0.8_OOD,
InD1000_0.9 = list1000_0.9_InD,
OOD1000_0.9 = list1000_0.9_OOD,
InD1000_0.8 = list1000_0.8_InD,
OOD1000_0.8 = list1000_0.8_OOD)
rownames(MNIST) <- OOD_Datasets
paged_table(MNIST)
rm(list = ls())
source("function.R")
InD_Dataset = "MNIST"
OOD_Datasets = c("FashionMNIST", "Cifar_10", "SVHN", "Imagenet_r", "Imagenet_c")
model_fit_test(trainset = InD_Dataset, testsets = OOD_Datasets, n_tr = 1000, n_ts = 1000, f = 16)  # Run only once, specify the training samples to use
InD_Dataset = "MNIST"
OOD_Datasets = c("FashionMNIST", "Cifar_10", "SVHN", "Imagenet_r", "Imagenet_c")
rm(list = ls())
source("function.R")
InD_Dataset = "MNIST"
OOD_Datasets = c("FashionMNIST", "Cifar_10", "SVHN", "Imagenet_r", "Imagenet_c")
model_fit_test(trainset = InD_Dataset, testsets = OOD_Datasets, n_tr = 1000, n_ts = 1000, f = 16)  # Run only once, specify the training samples to use
f = 16
list3000_0.9_InD = c()
list3000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 3000)
list3000_0.9_InD = c(list3000_0.9_InD, pred$ID_all)
list3000_0.9_OOD = c(list3000_0.9_OOD, pred$OOD_all)
}
list3000_0.8_InD = c()
list3000_0.8_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 3000)
list3000_0.8_InD = c(list3000_0.8_InD, pred$ID_all)
list3000_0.8_OOD = c(list3000_0.8_OOD, pred$OOD_all)
}
list1000_0.9_InD = c()
list1000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 1000)
list1000_0.9_InD = c(list1000_0.9_InD, pred$ID_all)
list1000_0.9_OOD = c(list1000_0.9_OOD, pred$OOD_all)
}
list1000_0.8_InD = c()
list1000_0.8_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 1000)
list1000_0.8_InD = c(list1000_0.8_InD, pred$ID_all)
list1000_0.8_OOD = c(list1000_0.8_OOD, pred$OOD_all)
}
MNIST = data.frame(InD3000_0.9 = list3000_0.9_InD,
OOD3000_0.9 = list3000_0.9_OOD,
InD3000_0.8 = list3000_0.8_InD,
OOD3000_0.8 = list3000_0.8_OOD,
InD1000_0.9 = list1000_0.9_InD,
OOD1000_0.9 = list1000_0.9_OOD,
InD1000_0.8 = list1000_0.8_InD,
OOD1000_0.8 = list1000_0.8_OOD)
rownames(MNIST) <- OOD_Datasets
paged_table(MNIST)
f = 32
list3000_0.9_InD = c()
list3000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 3000)
list3000_0.9_InD = c(list3000_0.9_InD, pred$ID_all)
list3000_0.9_OOD = c(list3000_0.9_OOD, pred$OOD_all)
}
list3000_0.8_InD = c()
list3000_0.8_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 3000)
list3000_0.8_InD = c(list3000_0.8_InD, pred$ID_all)
list3000_0.8_OOD = c(list3000_0.8_OOD, pred$OOD_all)
}
list1000_0.9_InD = c()
list1000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 1000)
list1000_0.9_InD = c(list1000_0.9_InD, pred$ID_all)
list1000_0.9_OOD = c(list1000_0.9_OOD, pred$OOD_all)
}
list1000_0.8_InD = c()
list1000_0.8_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 1000)
list1000_0.8_InD = c(list1000_0.8_InD, pred$ID_all)
list1000_0.8_OOD = c(list1000_0.8_OOD, pred$OOD_all)
}
MNIST = data.frame(InD3000_0.9 = list3000_0.9_InD,
OOD3000_0.9 = list3000_0.9_OOD,
InD3000_0.8 = list3000_0.8_InD,
OOD3000_0.8 = list3000_0.8_OOD,
InD1000_0.9 = list1000_0.9_InD,
OOD1000_0.9 = list1000_0.9_OOD,
InD1000_0.8 = list1000_0.8_InD,
OOD1000_0.8 = list1000_0.8_OOD)
rownames(MNIST) <- OOD_Datasets
paged_table(MNIST)
result = score_function(InD_Dataset, OOD_Datasets[1], q = 0.9, f = 16, n_tr = 1000, n_ts = 1000)
hist_plot_meanSD(result$test.df, result$ood.df, result$cv_results, OOD_Datasets[1], "std")
result = score_function(InD_Dataset, OOD_Datasets[2], q = 0.9, f = 16, n_tr = 1000, n_ts = 1000)
hist_plot_meanSD(result$test.df, result$ood.df, result$cv_results, OOD_Datasets[2], "std")
result = score_function(InD_Dataset, OOD_Datasets[3], q = 0.9, f = 16, n_tr = 1000, n_ts = 1000)
hist_plot_meanSD(result$test.df, result$ood.df, result$cv_results, OOD_Datasets[3], "std")
result = score_function(InD_Dataset, OOD_Datasets[4], q = 0.9, f = 16, n_tr = 1000, n_ts = 1000)
hist_plot_meanSD(result$test.df, result$ood.df, result$cv_results, OOD_Datasets[4], "std")
result = score_function(InD_Dataset, OOD_Datasets[5], q = 0.9, f = 16, n_tr = 1000, n_ts = 1000)
hist_plot_meanSD(result$test.df, result$ood.df, result$cv_results, OOD_Datasets[5], "std")
InD_Dataset = "MNIST"
OOD_Datasets = c("FashionMNIST", "Cifar_10", "SVHN", "Imagenet_r", "Imagenet_c")
model_fit_test(trainset = InD_Dataset, testsets = OOD_Datasets, n_tr = 1000, n_ts = 1000, f = 10)  # Run only once, specify the training samples to use
f = 10
list3000_0.9_InD = c()
list3000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 3000)
list3000_0.9_InD = c(list3000_0.9_InD, pred$ID_all)
list3000_0.9_OOD = c(list3000_0.9_OOD, pred$OOD_all)
}
list3000_0.8_InD = c()
list3000_0.8_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 3000)
list3000_0.8_InD = c(list3000_0.8_InD, pred$ID_all)
list3000_0.8_OOD = c(list3000_0.8_OOD, pred$OOD_all)
}
list1000_0.9_InD = c()
list1000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 1000)
list1000_0.9_InD = c(list1000_0.9_InD, pred$ID_all)
list1000_0.9_OOD = c(list1000_0.9_OOD, pred$OOD_all)
}
list1000_0.8_InD = c()
list1000_0.8_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 1000)
list1000_0.8_InD = c(list1000_0.8_InD, pred$ID_all)
list1000_0.8_OOD = c(list1000_0.8_OOD, pred$OOD_all)
}
MNIST = data.frame(InD3000_0.9 = list3000_0.9_InD,
OOD3000_0.9 = list3000_0.9_OOD,
InD3000_0.8 = list3000_0.8_InD,
OOD3000_0.8 = list3000_0.8_OOD,
InD1000_0.9 = list1000_0.9_InD,
OOD1000_0.9 = list1000_0.9_OOD,
InD1000_0.8 = list1000_0.8_InD,
OOD1000_0.8 = list1000_0.8_OOD)
rownames(MNIST) <- OOD_Datasets
paged_table(MNIST)
InD_Dataset = "MNIST"
OOD_Datasets = c("FashionMNIST", "Cifar_10", "SVHN", "Imagenet_r", "Imagenet_c")
model_fit_test(trainset = InD_Dataset, testsets = OOD_Datasets, n_tr = 5000, n_ts = 1000, f = 10)  # Run only once, specify the training samples to use
f = 10
list5000_0.9_InD = c()
list5000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 5000)
list5000_0.9_InD = c(list5000_0.9_InD, pred$ID_all)
list5000_0.9_OOD = c(list5000_0.9_OOD, pred$OOD_all)
}
list5000_0.8_InD = c()
list5000_0.8_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 5000)
list5000_0.8_InD = c(list5000_0.8_InD, pred$ID_all)
list5000_0.8_OOD = c(list5000_0.8_OOD, pred$OOD_all)
}
list3000_0.9_InD = c()
list3000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 3000)
list3000_0.9_InD = c(list3000_0.9_InD, pred$ID_all)
list3000_0.9_OOD = c(list3000_0.9_OOD, pred$OOD_all)
}
list3000_0.8_InD = c()
list3000_0.8_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 3000)
list3000_0.8_InD = c(list3000_0.8_InD, pred$ID_all)
list3000_0.8_OOD = c(list3000_0.8_OOD, pred$OOD_all)
}
list1000_0.9_InD = c()
list1000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 1000)
list1000_0.9_InD = c(list1000_0.9_InD, pred$ID_all)
list1000_0.9_OOD = c(list1000_0.9_OOD, pred$OOD_all)
}
list1000_0.8_InD = c()
list1000_0.8_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 1000)
list1000_0.8_InD = c(list1000_0.8_InD, pred$ID_all)
list1000_0.8_OOD = c(list1000_0.8_OOD, pred$OOD_all)
}
MNIST = data.frame(InD5000_0.9 = list5000_0.9_InD,
OOD5000_0.9 = list5000_0.9_OOD,
InD5000_0.8 = list5000_0.8_InD,
OOD5000_0.8 = list5000_0.8_OOD,
InD3000_0.9 = list3000_0.9_InD,
OOD3000_0.9 = list3000_0.9_OOD,
InD3000_0.8 = list3000_0.8_InD,
OOD3000_0.8 = list3000_0.8_OOD,
InD1000_0.9 = list1000_0.9_InD,
OOD1000_0.9 = list1000_0.9_OOD,
InD1000_0.8 = list1000_0.8_InD,
OOD1000_0.8 = list1000_0.8_OOD)
rownames(MNIST) <- OOD_Datasets
paged_table(MNIST)
rm(list = ls())
source("function.R")
InD_Dataset = "MNIST"
OOD_Datasets = c("FashionMNIST", "Cifar_10", "SVHN", "Imagenet_r", "Imagenet_c")
model_fit_test(trainset = InD_Dataset, testsets = OOD_Datasets, n_tr = 1000, n_ts = 1000, f = 32)  # Run only once, specify the training samples to use
f = 32
list3000_0.9_InD = c()
list3000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 3000)
list3000_0.9_InD = c(list3000_0.9_InD, pred$ID_all)
list3000_0.9_OOD = c(list3000_0.9_OOD, pred$OOD_all)
}
list3000_0.8_InD = c()
list3000_0.8_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 3000)
list3000_0.8_InD = c(list3000_0.8_InD, pred$ID_all)
list3000_0.8_OOD = c(list3000_0.8_OOD, pred$OOD_all)
}
list1000_0.9_InD = c()
list1000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 1000)
list1000_0.9_InD = c(list1000_0.9_InD, pred$ID_all)
list1000_0.9_OOD = c(list1000_0.9_OOD, pred$OOD_all)
}
list1000_0.8_InD = c()
list1000_0.8_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 1000)
list1000_0.8_InD = c(list1000_0.8_InD, pred$ID_all)
list1000_0.8_OOD = c(list1000_0.8_OOD, pred$OOD_all)
}
MNIST = data.frame(InD3000_0.9 = list3000_0.9_InD,
OOD3000_0.9 = list3000_0.9_OOD,
InD3000_0.8 = list3000_0.8_InD,
OOD3000_0.8 = list3000_0.8_OOD,
InD1000_0.9 = list1000_0.9_InD,
OOD1000_0.9 = list1000_0.9_OOD,
InD1000_0.8 = list1000_0.8_InD,
OOD1000_0.8 = list1000_0.8_OOD)
rownames(MNIST) <- OOD_Datasets
paged_table(MNIST)
rm(list = ls())
source("function.R")
InD_Dataset = "MNIST"
OOD_Datasets = c("FashionMNIST", "Cifar_10", "SVHN", "Imagenet_r", "Imagenet_c")
model_fit_test(trainset = InD_Dataset, testsets = OOD_Datasets, n_tr = 1000, n_ts = 1000, f = 16)  # Run only once, specify the training samples to use
InD_Dataset = "MNIST"
OOD_Datasets = c("FashionMNIST", "Cifar_10", "SVHN", "Imagenet_r", "Imagenet_c")
f = 16
list3000_0.9_InD = c()
list3000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 3000)
list3000_0.9_InD = c(list3000_0.9_InD, pred$ID_all)
list3000_0.9_OOD = c(list3000_0.9_OOD, pred$OOD_all)
}
list3000_0.8_InD = c()
list3000_0.8_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 3000)
list3000_0.8_InD = c(list3000_0.8_InD, pred$ID_all)
list3000_0.8_OOD = c(list3000_0.8_OOD, pred$OOD_all)
}
list1000_0.9_InD = c()
list1000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 1000)
list1000_0.9_InD = c(list1000_0.9_InD, pred$ID_all)
list1000_0.9_OOD = c(list1000_0.9_OOD, pred$OOD_all)
}
list1000_0.8_InD = c()
list1000_0.8_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 1000)
list1000_0.8_InD = c(list1000_0.8_InD, pred$ID_all)
list1000_0.8_OOD = c(list1000_0.8_OOD, pred$OOD_all)
}
MNIST = data.frame(InD3000_0.9 = list3000_0.9_InD,
OOD3000_0.9 = list3000_0.9_OOD,
InD3000_0.8 = list3000_0.8_InD,
OOD3000_0.8 = list3000_0.8_OOD,
InD1000_0.9 = list1000_0.9_InD,
OOD1000_0.9 = list1000_0.9_OOD,
InD1000_0.8 = list1000_0.8_InD,
OOD1000_0.8 = list1000_0.8_OOD)
rownames(MNIST) <- OOD_Datasets
paged_table(MNIST)
InD_Dataset = "MNIST"
OOD_Datasets = c("FashionMNIST", "Cifar_10", "SVHN", "Imagenet_r", "Imagenet_c")
model_fit_test(trainset = InD_Dataset, testsets = OOD_Datasets, n_tr = 1000, n_ts = 1000, f = 16)  # Run only once, specify the training samples to use
f = 16
list3000_0.9_InD = c()
list3000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 3000)
list3000_0.9_InD = c(list3000_0.9_InD, pred$ID_all)
list3000_0.9_OOD = c(list3000_0.9_OOD, pred$OOD_all)
}
list3000_0.8_InD = c()
list3000_0.8_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 3000)
list3000_0.8_InD = c(list3000_0.8_InD, pred$ID_all)
list3000_0.8_OOD = c(list3000_0.8_OOD, pred$OOD_all)
}
list1000_0.9_InD = c()
list1000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 1000)
list1000_0.9_InD = c(list1000_0.9_InD, pred$ID_all)
list1000_0.9_OOD = c(list1000_0.9_OOD, pred$OOD_all)
}
list1000_0.8_InD = c()
list1000_0.8_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 1000)
list1000_0.8_InD = c(list1000_0.8_InD, pred$ID_all)
list1000_0.8_OOD = c(list1000_0.8_OOD, pred$OOD_all)
}
MNIST = data.frame(InD3000_0.9 = list3000_0.9_InD,
OOD3000_0.9 = list3000_0.9_OOD,
InD3000_0.8 = list3000_0.8_InD,
OOD3000_0.8 = list3000_0.8_OOD,
InD1000_0.9 = list1000_0.9_InD,
OOD1000_0.9 = list1000_0.9_OOD,
InD1000_0.8 = list1000_0.8_InD,
OOD1000_0.8 = list1000_0.8_OOD)
rownames(MNIST) <- OOD_Datasets
paged_table(MNIST)
rm(list = ls())
source("function.R")
InD_Dataset = "MNIST"
OOD_Datasets = c("FashionMNIST", "Cifar_10", "SVHN", "Imagenet_r", "Imagenet_c")
model_fit_test(trainset = InD_Dataset, testsets = OOD_Datasets, n_tr = 1000, n_ts = 1000, f = 18)  # Run only once, specify the training samples to use
rm(list = ls())
source("function.R")
InD_Dataset = "MNIST"
OOD_Datasets = c("FashionMNIST", "Cifar_10", "SVHN", "Imagenet_r", "Imagenet_c")
model_fit_test(trainset = InD_Dataset, testsets = OOD_Datasets, n_tr = 1000, n_ts = 1000, f = 18)  # Run only once, specify the training samples to use
f = 18
list3000_0.9_InD = c()
list3000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 3000)
list3000_0.9_InD = c(list3000_0.9_InD, pred$ID_all)
list3000_0.9_OOD = c(list3000_0.9_OOD, pred$OOD_all)
}
f = 18
# list3000_0.9_InD = c()
# list3000_0.9_OOD = c()
# for (i in 1:5){
#   pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 3000)
#   list3000_0.9_InD = c(list3000_0.9_InD, pred$ID_all)
#   list3000_0.9_OOD = c(list3000_0.9_OOD, pred$OOD_all)
# }
#
# list3000_0.8_InD = c()
# list3000_0.8_OOD = c()
# for (i in 1:5){
#   pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 3000)
#   list3000_0.8_InD = c(list3000_0.8_InD, pred$ID_all)
#   list3000_0.8_OOD = c(list3000_0.8_OOD, pred$OOD_all)
# }
list1000_0.9_InD = c()
list1000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 1000)
list1000_0.9_InD = c(list1000_0.9_InD, pred$ID_all)
list1000_0.9_OOD = c(list1000_0.9_OOD, pred$OOD_all)
}
list1000_0.8_InD = c()
list1000_0.8_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 1000)
list1000_0.8_InD = c(list1000_0.8_InD, pred$ID_all)
list1000_0.8_OOD = c(list1000_0.8_OOD, pred$OOD_all)
}
MNIST = data.frame(InD1000_0.9 = list1000_0.9_InD,
OOD1000_0.9 = list1000_0.9_OOD,
InD1000_0.8 = list1000_0.8_InD,
OOD1000_0.8 = list1000_0.8_OOD)
rownames(MNIST) <- OOD_Datasets
paged_table(MNIST)
rm(list = ls())
source("function.R")
InD_Dataset = "MNIST"
OOD_Datasets = c("FashionMNIST", "Cifar_10", "SVHN", "Imagenet_r", "Imagenet_c")
model_fit_test(trainset = InD_Dataset, testsets = OOD_Datasets, n_tr = 1000, n_ts = 1000, f = 32)  # Run only once, specify the training samples to use
f = 32
# list3000_0.9_InD = c()
# list3000_0.9_OOD = c()
# for (i in 1:5){
#   pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 3000)
#   list3000_0.9_InD = c(list3000_0.9_InD, pred$ID_all)
#   list3000_0.9_OOD = c(list3000_0.9_OOD, pred$OOD_all)
# }
#
# list3000_0.8_InD = c()
# list3000_0.8_OOD = c()
# for (i in 1:5){
#   pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 3000)
#   list3000_0.8_InD = c(list3000_0.8_InD, pred$ID_all)
#   list3000_0.8_OOD = c(list3000_0.8_OOD, pred$OOD_all)
# }
list1000_0.9_InD = c()
list1000_0.9_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.9, f = f, n_tr = 1000)
list1000_0.9_InD = c(list1000_0.9_InD, pred$ID_all)
list1000_0.9_OOD = c(list1000_0.9_OOD, pred$OOD_all)
}
list1000_0.8_InD = c()
list1000_0.8_OOD = c()
for (i in 1:5){
pred = score_function(InD_Dataset, OOD_Datasets[i], q = 0.8, f = f, n_tr = 1000)
list1000_0.8_InD = c(list1000_0.8_InD, pred$ID_all)
list1000_0.8_OOD = c(list1000_0.8_OOD, pred$OOD_all)
}
MNIST = data.frame(InD1000_0.9 = list1000_0.9_InD,
OOD1000_0.9 = list1000_0.9_OOD,
InD1000_0.8 = list1000_0.8_InD,
OOD1000_0.8 = list1000_0.8_OOD)
rownames(MNIST) <- OOD_Datasets
paged_table(MNIST)
